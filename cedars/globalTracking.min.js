let enableLogging=!0;function toPlainLower(e){return String(e||"").trim().toLowerCase().replace(/[^a-z0-9&.\-_, |]+/g,"")}function getUrlSegment(e){return(location.pathname.split("/").filter(Boolean)[e-1]||"").split(".")[0]}function getErrorInfo(){var e,t,n={400:"bad request",401:"unauthorized",403:"forbidden",404:"not found",500:"internal server error",502:"bad gateway",503:"service unavailable",504:"gateway timeout"},a=document.title.toLowerCase();for({pattern:e,code:t}of[{pattern:/404|not found/,code:404},{pattern:/403|forbidden/,code:403},{pattern:/401|unauthorized/,code:401},{pattern:/400|bad request/,code:400},{pattern:/500|internal server error/,code:500},{pattern:/502|bad gateway/,code:502},{pattern:/503|service unavailable/,code:503},{pattern:/504|gateway timeout/,code:504}])if(e.test(a))return{code:t.toString(),label:n[t]||"error "+t};return null}let ARTICLE_CATEGORIES=new Set(["healthy-living","expert-advice","research-innovations","community-impact","international"]);function isArticleDetail(e=location){var t,e=e.pathname.replace(/(^\/+|\/+$)/g,"").split("/").filter(Boolean);return"stories-and-insights"===e[0]&&(t=e[1]||"",!!ARTICLE_CATEGORIES.has(t))&&!!(t=e[2])&&!new Set(["page","tag","category","topics","author","archive"]).has(t)}let userECID=Visitor.getInstance("cedarssinai")?.getMarketingCloudVisitorID?.();if(!isArticleDetail()){window.adobeDataLayer=window.adobeDataLayer||[];let e=getErrorInfo(),t={event:"pageView",userECID:userECID,navigation:{domain:location.hostname,siteSection:getUrlSegment(1),siteSubsection1:getUrlSegment(2),siteSubsection2:getUrlSegment(3),siteSubsection3:getUrlSegment(4),siteSubsection4:getUrlSegment(5),pageURL:location.href,refURL:document.referrer||""},pageName:"cs-org:cedars-sinai:"+location.pathname.substring(1).replaceAll("/",":").split(".")[0],pageTitle:(()=>{var e=document.querySelector("h1");return toPlainLower(e?e.textContent:document.title)})(),eventTimestamp:Date.now()};e&&(t.errors=e),adobeDataLayer.push(t)}function handleAnalyticsClick(t){if(!t._adobeProcessed){t._adobeProcessed=!0;t=t.target.closest("a, button, [data-track-click]");if(t){var n=t.getAttribute("href")||"",a=toPlainLower((t.innerText||t.getAttribute("aria-label")||"").replace(/\n+/g," ").replace(/\s+/g," ").trim()),o=n.startsWith("tel:"),i=n.startsWith("mailto:"),r=n.startsWith("http")&&!n.includes(window.location.hostname),o=o||i||r,i=(t.closest("[data-component-name]")?.getAttribute("data-component-name")||"").toLowerCase(),r=toPlainLower(t.closest("[data-component-title]")?.getAttribute("data-component-title")||""),l=(t.getAttribute("data-link-action")||"link").toLowerCase(),c=(t.getAttribute("data-link-type")||"cta").toLowerCase();let e={};"article grid"===i?(e={event:"click",componentName:"article grid",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:a,linkType:c,eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'article grid':",e)):"related articles"===i?(e={event:"click",componentName:"related articles",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'related articles':",e)):"product ad"===i?(e={event:"click",componentName:"product ad",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'product ad':",e)):"color card"===i?(e={event:"click",componentName:"color card",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'color card':",e)):"subscribe"===i?(e={event:"click",componentName:"subscribe",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'subscribe':",e)):"topics menu"===i?(e={event:"click",componentName:"topics menu",componentTitle:r,clickHref:n,isExternalLink:o,linkAction:l,linkText:a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'topics menu':",e)):"pagination"===i?(t=t.getAttribute("data-link-text")||"",e={event:"click",componentName:"pagination",componentTitle:r,linkHref:n,isExternalLink:o,linkAction:"link",linkText:t?toPlainLower(t.replace(/\n+/g," ").replace(/\s+/g," ").trim()):a,linkType:"cta",eventTimestamp:Date.now()},enableLogging&&console.log("Tracking event 'pagination':",e)):i&&(e={event:"click",componentName:i,componentTitle:r,linkHref:n,isExternalLink:o,linkAction:l,linkText:a,linkType:c,eventTimestamp:Date.now()},enableLogging)&&console.log("Tracking event 'generic':",e),e.event&&(adobeDataLayer.push(e),enableLogging)&&console.log(`DataLayer for ${window.location.href}:`,JSON.stringify(adobeDataLayer,null,2))}}}function trackProductAdImpressions({selector:e='[data-component-name="product ad"]',placementAttr:a="data-impression-placement",creativeAttr:o="data-impression-creative",contentAttr:i="data-impression-content"}={}){let r=new WeakSet,t=new IntersectionObserver(e=>{e.forEach(e=>{var t,n;.75<=e.intersectionRatio&&!r.has(e.target)&&(r.add(e.target),t=toPlainLower((e=e.target).getAttribute(a)||""),n=toPlainLower(e.getAttribute(o)||""),e=toPlainLower(e.getAttribute(i)||""),window.adobeDataLayer?.push({event:"impression",eventTimestamp:Date.now(),impression:"product ad",impressionPlacement:t||"",impressionCreative:n||"",impressionContent:e||void 0}))})},{threshold:[0,.75,1]});document.querySelectorAll(e).forEach(e=>t.observe(e))}function trackFormLoadsOnView(e="form[data-form-name]"){let n=new WeakSet,t=new IntersectionObserver(e=>{e.forEach(({target:e,isIntersecting:t})=>{t&&!n.has(e)&&(n.add(e),t=e.getAttribute("data-form-name")||e.name||e.id||"unnamed-form",e=e.getAttribute("data-app")||"stories-and-insights",window.adobeDataLayer?.push({event:"form",eventTimestamp:Date.now(),form:{action:"load",application:e,name:t}}))})},{threshold:.01});document.querySelectorAll(e).forEach(e=>t.observe(e))}function pushAdobeFormEvent({eventType:e,application:t,action:n="interaction",formName:a,fieldName:o,fieldValue:i,extra:r={}}){n={event:"form",eventTimestamp:Date.now(),form:{action:n,application:t,name:a},eventType:e,fieldName:o,fieldValue:i,...r};window.adobeDataLayer.push(n)}function maskValueIfPII(e,t,n,a){return a?(a=(e||"").toLowerCase(),e=(t||"").toLowerCase(),t=/email/.test(a)||"email"===e||/\S+@\S+\.\S+/.test(n),e=/phone|mobile|tel/.test(a)||"tel"===e,a=/name|firstname|lastname|first_name|last_name/.test(a),t?"[email]":e?"[phone]":a?"[name]":n):n}function readFieldValue(e){var t,n,a;if(e)return a=e.tagName.toLowerCase(),t=(e.type||"").toLowerCase(),"select"===a?e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value:"checkbox"===t?(a=e.form?e.form.querySelectorAll(`input[type="checkbox"][name="${CSS.escape(e.name)}"]`):[e],n=Array.from(a).filter(e=>e.checked).map(e=>e.value||!0),e.name&&1<a.length?n:e.checked):"radio"===t?(a=e.form?.querySelector(`input[type="radio"][name="${CSS.escape(e.name)}"]:checked`))?a.value:null:"file"===t?e.files?.length?"[file-selected]":"[no-file]":e.value}function attachFormTracking(e=document,{application:t="stories-and-insights",formNameAttr:n="data-form-name",appAttr:i="data-app",selector:a="form"}={}){e.querySelectorAll(a).forEach(e=>{let a=e.getAttribute(n)||e.getAttribute("name")||e.id||"unnamed-form",o=e.getAttribute(i)||t;e.querySelectorAll("input, select, textarea").forEach(e=>{let n=e.name||e.id||e.getAttribute("data-field")||"unnamed-field";var t=(e.type||e.tagName).toLowerCase();if(e.addEventListener("focus",()=>{pushAdobeFormEvent({eventType:"focus",application:o,action:"interaction",formName:a,fieldName:n})}),e.addEventListener("blur",()=>{pushAdobeFormEvent({eventType:"blur",application:o,action:"interaction",formName:a,fieldName:n})}),"select"===e.tagName.toLowerCase()){let t=()=>{pushAdobeFormEvent({eventType:"open",application:o,action:"interaction",formName:a,fieldName:n})};e.addEventListener("mousedown",t,{passive:!0}),e.addEventListener("pointerdown",t,{passive:!0}),e.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key&&"ArrowDown"!==e.key&&"ArrowUp"!==e.key||t()})}/^(checkbox|radio)$/i.test(t)&&e.addEventListener("change",()=>{pushAdobeFormEvent({eventType:"toggle",application:o,action:"interaction",formName:a,fieldName:n})})})})}function pushFormOutcome({application:e,name:t,submitStatus:n,errors:a}){window.adobeDataLayer=window.adobeDataLayer||[];e={event:"form",eventTimestamp:Date.now(),form:{action:"submit",application:e,name:t,submitStatus:n}};a&&(e.form.errors=a),window.adobeDataLayer.push(e)}function collectClientErrorsFromValidator(e){return{label:e.errorList.map(e=>{e.element;return(e.message||"This field is required.").trim()}),location:"form"}}function attachFormOutcomeTracking(o,{application:i="stories-and-insights",formNameAttr:e="data-form-name"}={}){let r=o.getAttribute(e)||o.getAttribute("name")||o.id||"unnamed-form",l=!1;if(window.jQuery&&jQuery.fn.validate){e=jQuery(o),e=e.data("validator")||e.validate({});let a=e.settings.invalidHandler,t=(e.settings.invalidHandler=function(e,t){try{var n=collectClientErrorsFromValidator(t);pushFormOutcome({application:i,name:r,submitStatus:!1,errors:n})}finally{"function"==typeof a&&a.call(this,e,t)}},e.settings.submitHandler);e.settings.submitHandler=e=>{if(l=!0,window.adobeDataLayer.push({event:"form",eventTimestamp:Date.now(),form:{action:"submit-start",application:i,name:r}}),"function"==typeof t)return t(e);e.submit()}}else o.addEventListener("submit",()=>{l=!0},{capture:!0});function c(e){e=window.getComputedStyle(e);return"none"!==e.display&&"hidden"!==e.visibility}new MutationObserver(e=>{var t,n=o.parentElement?.querySelector(".w-form-done"),a=o.parentElement?.querySelector(".w-form-fail");l&&(n=n&&c(n),t=a&&c(a),n?(l=!1,pushFormOutcome({application:i,name:r,submitStatus:!0})):t&&(l=!1,n=(a.textContent||"").trim(),pushFormOutcome({application:i,name:r,submitStatus:!1,errors:{label:n?[n]:["Submission failed"],location:"form"}})))}).observe(document.body,{childList:!0,subtree:!0})}let __outcomeBound=new WeakSet;function initOutcomeTrackingOnAllForms({defaultApplication:n="stories-and-insights",formNameAttr:a="data-form-name",appAttr:o="data-app"}={}){let i=e=>{var t;e instanceof HTMLFormElement&&(__outcomeBound.has(e)||e.hasAttribute(a)&&(t=e.getAttribute(o)||n,attachFormOutcomeTracking(e,{application:t,formNameAttr:a}),__outcomeBound.add(e)))};document.querySelectorAll(`form[${a}]`).forEach(i),new MutationObserver(e=>{for(var t of e)for(var n of t.addedNodes)n instanceof Element&&(n.matches?.(`form[${a}]`)&&i(n),n.querySelectorAll?.(`form[${a}]`).forEach(i))}).observe(document.documentElement,{childList:!0,subtree:!0})}document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",handleAnalyticsClick),trackFormLoadsOnView(),attachFormTracking(document,{application:"stories-and-insights",sendValues:!1}),trackProductAdImpressions(),initOutcomeTrackingOnAllForms({defaultApplication:"stories-and-insights",formNameAttr:"data-form-name",appAttr:"data-app"})});