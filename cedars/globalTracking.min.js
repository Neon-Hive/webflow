let enableLogging=window.enableLogging;function toPlainLower(e){return String(e||"").trim().toLowerCase().replace(/[^a-z0-9&.\-_, |]+/g,"")}function getUrlSegment(e){return(location.pathname.split("/").filter(Boolean)[e-1]||"").split(".")[0]}function getErrorInfo(){var e,t,n={400:"bad request",401:"unauthorized",403:"forbidden",404:"not found",500:"internal server error",502:"bad gateway",503:"service unavailable",504:"gateway timeout"},a=document.title.toLowerCase();for({pattern:e,code:t}of[{pattern:/404|not found/,code:404},{pattern:/403|forbidden/,code:403},{pattern:/401|unauthorized/,code:401},{pattern:/400|bad request/,code:400},{pattern:/500|internal server error/,code:500},{pattern:/502|bad gateway/,code:502},{pattern:/503|service unavailable/,code:503},{pattern:/504|gateway timeout/,code:504}])if(e.test(a))return{code:t.toString(),label:n[t]||"error "+t};return null}let ARTICLE_CATEGORIES=new Set(["expert-advice","healthy-living","research-innovations","community-impact","international"]);function isArticleDetail(e=location){var t,e=e.pathname.replace(/(^\/+|\/+$)/g,"").split("/").filter(Boolean);return"stories-and-insights"===e[0]&&(t=e[1]||"",!!ARTICLE_CATEGORIES.has(t))&&!!(t=e[2])&&!new Set(["page","tag","category","topics","author","archive"]).has(t)}function getUserECID(){if("undefined"!=typeof Visitor&&Visitor.getInstance)return Visitor.getInstance("cedarssinai")?.getMarketingCloudVisitorID?.()}function getUserECIDAsync(i=5e3,o=100){return new Promise(t=>{let n=Date.now(),a=()=>{var e=getUserECID();e?t(e):(e=Date.now()-n,i<=e?t(void 0):setTimeout(a,o))};a()})}if(!isArticleDetail()){window.adobeDataLayer=window.adobeDataLayer||[];let t=getErrorInfo();getUserECIDAsync().then(e=>{e={event:"pageView",ecid:e||void 0,navigation:{domain:location.hostname,siteSection:getUrlSegment(1),siteSubsection1:getUrlSegment(2),siteSubsection2:getUrlSegment(3),siteSubsection3:getUrlSegment(4),siteSubsection4:getUrlSegment(5),pageURL:location.href,refURL:document.referrer||""},pageName:"cs-org:cedars-sinai:"+location.pathname.substring(1).replaceAll("/",":").split(".")[0],pageTitle:toPlainLower((e=document.querySelector("h1"))?e.textContent:document.title),eventTimestamp:Date.now()};t&&(e.errors=t),adobeDataLayer.push(e),enableLogging&&console.log(`DataLayer for ${window.location.href}:`,JSON.stringify(e,null,2))})}function handleAnalyticsClick(n){if(!n._adobeProcessed){n._adobeProcessed=!0;n=n.target.closest("a, button, [data-track-click]");if(n){var a=n.getAttribute("href")||"",i=toPlainLower((n.innerText||n.getAttribute("aria-label")||"").replace(/\n+/g," ").replace(/\s+/g," ").trim()),o=a.startsWith("tel:"),e=a.startsWith("mailto:"),r=a.startsWith("http")&&!a.includes(window.location.hostname),o=o||e||r,e=(n.closest("[data-component-name]")?.getAttribute("data-component-name")||"").toLowerCase(),r=toPlainLower(n.closest("[data-component-title]")?.getAttribute("data-component-title")||""),l=(n.getAttribute("data-link-action")||"link").toLowerCase(),c=n.closest("[data-link-type]")?.getAttribute("data-link-type")||"cta".toLowerCase(),s=(n.getAttribute("data-section")||n.closest("[data-section]")?.getAttribute("data-section")||"").toLowerCase();let t={};if("article grid"===e){let e=i;var m=(n.closest("[data-component-name='article grid']")||n).querySelector("p[data-headline]")||n.querySelector("p[data-headline]");m&&(m=m.textContent.trim(),e=toPlainLower(m)),t={event:"click",componentName:"article grid",componentTitle:r,linkHref:a,isExternalLink:o,linkAction:"link",linkText:e,section:s,linkType:c,eventTimestamp:Date.now()}}else if("related articles"===e){let e=i;m=(n.closest("[data-component-name='related articles']")||n).querySelector("p.articles-small_text.u-text-style-title-m");m&&(e=toPlainLower(m.textContent.trim())),t={event:"click",componentName:"related articles",componentTitle:r,linkHref:a,isExternalLink:o,linkAction:"link",linkText:e,section:s,linkType:"cta",eventTimestamp:Date.now()}}else if("product ad"===e)t={event:"click",componentName:"product ad",componentTitle:r,linkHref:a,isExternalLink:o,linkAction:"link",linkText:i,section:s,linkType:"cta",eventTimestamp:Date.now()};else if("color card"===e)t={event:"click",componentName:"color card",componentTitle:r,linkHref:a,isExternalLink:o,linkAction:"link",linkText:i,linkType:"cta",eventTimestamp:Date.now()};else if("subscribe"===e)t={event:"click",componentName:"subscribe",componentTitle:r,linkHref:a,isExternalLink:o,linkAction:"link",linkText:i,linkType:"cta",eventTimestamp:Date.now()};else if("topics menu"===e)t={event:"click",componentName:"topics menu",componentTitle:r,clickHref:a,isExternalLink:o,linkAction:l,linkText:i,linkType:"cta",eventTimestamp:Date.now()};else if("pagination"===e){var m=(a.startsWith("http")?new URL(a):new URL(a,window.location.origin)).search,s=new URL(window.location.href),s=s.origin+s.pathname+m,n=n.closest(".w-pagination-previous, .w-pagination-next")||n,d=n.classList,n=n.getAttribute("aria-label")||"",u=d.contains("w-pagination-previous")||n.toLowerCase().includes("previous"),d=d.contains("w-pagination-next")||n.toLowerCase().includes("next");let e;e=u?"previous":d?"next":(u=(n=m.match(/[?&]b583dbbd_page=(\d+)/))?n[1]:null)?"page "+u:i,t={event:"click",componentName:"pagination",componentTitle:r,linkHref:s,isExternalLink:o,linkAction:"link",linkText:toPlainLower(e),linkType:"cta",eventTimestamp:Date.now()}}else e&&(t={event:"click",componentName:e,componentTitle:r,linkHref:a,isExternalLink:o,linkAction:l,linkText:i,linkType:c,eventTimestamp:Date.now()});t.event&&(adobeDataLayer.push(t),enableLogging)&&console.log(`DataLayer for ${window.location.href}:`,JSON.stringify(adobeDataLayer,null,2))}}}function trackFormLoadsOnView(e="form[data-form-name]"){let n=new WeakSet,t=new IntersectionObserver(e=>{e.forEach(({target:e,isIntersecting:t})=>{t&&!n.has(e)&&(n.add(e),t=e.getAttribute("data-form-name")||e.name||e.id||"unnamed-form",e=e.getAttribute("data-app")||"stories-and-insights",window.adobeDataLayer?.push({event:"form",eventTimestamp:Date.now(),form:{action:"load",application:e,name:t}}))})},{threshold:.01});document.querySelectorAll(e).forEach(e=>t.observe(e))}function pushAdobeFormEvent({eventType:e,application:t,action:n="interaction",formName:a,fieldName:i,fieldValue:o,extra:r={}}){n={event:"form",eventTimestamp:Date.now(),form:{action:n,application:t,name:a},eventType:e,fieldName:i,fieldValue:o,...r};window.adobeDataLayer.push(n)}function maskValueIfPII(e,t,n,a){return a?(a=(e||"").toLowerCase(),e=(t||"").toLowerCase(),t=/email/.test(a)||"email"===e||/\S+@\S+\.\S+/.test(n),e=/phone|mobile|tel/.test(a)||"tel"===e,a=/name|firstname|lastname|first_name|last_name/.test(a),t?"[email]":e?"[phone]":a?"[name]":n):n}function readFieldValue(e){var t,n,a;if(e)return a=e.tagName.toLowerCase(),t=(e.type||"").toLowerCase(),"select"===a?e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value:"checkbox"===t?(a=e.form?e.form.querySelectorAll(`input[type="checkbox"][name="${CSS.escape(e.name)}"]`):[e],n=Array.from(a).filter(e=>e.checked).map(e=>e.value||!0),e.name&&1<a.length?n:e.checked):"radio"===t?(a=e.form?.querySelector(`input[type="radio"][name="${CSS.escape(e.name)}"]:checked`))?a.value:null:"file"===t?e.files?.length?"[file-selected]":"[no-file]":e.value}function attachFormTracking(e=document,{application:t="stories-and-insights",formNameAttr:n="data-form-name",appAttr:o="data-app",selector:a="form"}={}){e.querySelectorAll(a).forEach(e=>{let a=e.getAttribute(n)||e.getAttribute("name")||e.id||"unnamed-form",i=e.getAttribute(o)||t;e.querySelectorAll("input, select, textarea").forEach(e=>{let n=e.name||e.id||e.getAttribute("data-field")||"unnamed-field";var t=(e.type||e.tagName).toLowerCase();if(e.addEventListener("focus",()=>{pushAdobeFormEvent({eventType:"focus",application:i,action:"interaction",formName:a,fieldName:n})}),e.addEventListener("blur",()=>{pushAdobeFormEvent({eventType:"blur",application:i,action:"interaction",formName:a,fieldName:n})}),"select"===e.tagName.toLowerCase()){let t=()=>{pushAdobeFormEvent({eventType:"open",application:i,action:"interaction",formName:a,fieldName:n})};e.addEventListener("mousedown",t,{passive:!0}),e.addEventListener("pointerdown",t,{passive:!0}),e.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key&&"ArrowDown"!==e.key&&"ArrowUp"!==e.key||t()})}/^(checkbox|radio)$/i.test(t)&&e.addEventListener("change",()=>{pushAdobeFormEvent({eventType:"toggle",application:i,action:"interaction",formName:a,fieldName:n})})})})}function pushFormOutcome({application:e,name:t,submitStatus:n,errors:a}){window.adobeDataLayer=window.adobeDataLayer||[];e={event:"form",eventTimestamp:Date.now(),form:{action:"submit",application:e,name:t,submitStatus:n}};a&&(e.form.errors=a),window.adobeDataLayer.push(e)}function collectClientErrorsFromValidator(e){return{label:e.errorList.map(e=>{e.element;return(e.message||"This field is required.").trim()}),location:"form"}}function attachFormOutcomeTracking(i,{application:o="stories-and-insights",formNameAttr:e="data-form-name"}={}){let r=i.getAttribute(e)||i.getAttribute("name")||i.id||"unnamed-form",l=!1;if(window.jQuery&&jQuery.fn.validate){e=jQuery(i),e=e.data("validator")||e.validate({});let a=e.settings.invalidHandler,t=(e.settings.invalidHandler=function(e,t){try{var n=collectClientErrorsFromValidator(t);pushFormOutcome({application:o,name:r,submitStatus:!1,errors:n})}finally{"function"==typeof a&&a.call(this,e,t)}},e.settings.submitHandler);e.settings.submitHandler=e=>{if(l=!0,window.adobeDataLayer.push({event:"form",eventTimestamp:Date.now(),form:{action:"submit-start",application:o,name:r}}),"function"==typeof t)return t(e);e.submit()}}else i.addEventListener("submit",()=>{l=!0},{capture:!0});function c(e){e=window.getComputedStyle(e);return"none"!==e.display&&"hidden"!==e.visibility}new MutationObserver(e=>{var t,n=i.parentElement?.querySelector(".w-form-done"),a=i.parentElement?.querySelector(".w-form-fail");l&&(n=n&&c(n),t=a&&c(a),n?(l=!1,pushFormOutcome({application:o,name:r,submitStatus:!0})):t&&(l=!1,n=(a.textContent||"").trim(),pushFormOutcome({application:o,name:r,submitStatus:!1,errors:{label:n?[n]:["Submission failed"],location:"form"}})))}).observe(document.body,{childList:!0,subtree:!0})}let __outcomeBound=new WeakSet;function initOutcomeTrackingOnAllForms({defaultApplication:n="stories-and-insights",formNameAttr:a="data-form-name",appAttr:i="data-app"}={}){let o=e=>{var t;e instanceof HTMLFormElement&&(__outcomeBound.has(e)||e.hasAttribute(a)&&(t=e.getAttribute(i)||n,attachFormOutcomeTracking(e,{application:t,formNameAttr:a}),__outcomeBound.add(e)))};document.querySelectorAll(`form[${a}]`).forEach(o),new MutationObserver(e=>{for(var t of e)for(var n of t.addedNodes)n instanceof Element&&(n.matches?.(`form[${a}]`)&&o(n),n.querySelectorAll?.(`form[${a}]`).forEach(o))}).observe(document.documentElement,{childList:!0,subtree:!0})}document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",handleAnalyticsClick),trackFormLoadsOnView(),attachFormTracking(document,{application:"stories-and-insights",sendValues:!1});var e=document.querySelectorAll(".articles_collection-list");0<e.length&&(console.log("Article grids found:",e.length),e.forEach(e=>{e.querySelectorAll("[data-component-name='article grid']").forEach((e,t)=>{0===t?e.setAttribute("data-link-type","primary cta"):e.setAttribute("data-link-type","secondary cta")})})),initOutcomeTrackingOnAllForms({defaultApplication:"stories-and-insights",formNameAttr:"data-form-name",appAttr:"data-app"})});