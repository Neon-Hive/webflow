function addItemsToLocationData(){document.querySelectorAll(".location_block_result_item_wrap").forEach(t=>{let o=t.getAttribute("data-name");if(!locationData.some(e=>e.name===o)){let e=t.querySelector("img")?.getAttribute("src")||"";e&&""!==e.trim()&&"https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg"!==e||(e="https://cdn.prod.website-files.com/67ab6f4970b90367b528f15a/67aecfc6a895ff8fabea7a46_Staffing%20Support.webp"),locationData.push({name:o,lat:parseFloat(t.getAttribute("data-lat"))||0,lng:parseFloat(t.getAttribute("data-lng"))||0,imageUrl:e,link:t.getAttribute("data-link")?"/location/"+t.getAttribute("data-link"):"",country:t.getAttribute("data-country")||"",state:t.getAttribute("data-state")||"",city:t.getAttribute("data-city")||"",postcodes:t.getAttribute("data-postcode")||""})}}),window.dispatchEvent(new Event("locationDataLoaded"))}window.fsAttributes=window.fsAttributes||[],window.locationData=window.locationData||[],window.fsAttributes.push(["cmsload",t=>{window.fsAttributes.cmsnest.init().then(()=>{console.log("CMS Nest successfully initialized!"),document.querySelectorAll(".locations_loading-wrapper").forEach(e=>{e.style.display="none"}),document.querySelectorAll(".n4_loading-skeleton:not(.is-location-item)").forEach(e=>{e.style.display="none"}),document.querySelectorAll(".locations_nest").forEach(e=>{e.style.display=""});let[e]=t;window.fsAttributes.cmsfilter.init().then(()=>{console.log("CMS Filter successfully initialized!"),e.listInstance.on("renderitems",()=>{console.log("FinSweet Filtering Applied. Checking empty countries..."),checkForEmptyCountries()})}),console.log("CMS Nest loading complete.")}),t.forEach(e=>{e.on("loaded",()=>{addItemsToLocationData()})}),addItemsToLocationData()}]),document.addEventListener("DOMContentLoaded",function(){window.userLocation=null;var e=document.querySelectorAll(".locations_loading-wrapper");async function c(e=!1){if(!navigator.geolocation)return l("‚ùå Geolocation is not supported by your browser."),null;try{var t=await navigator.permissions.query({name:"geolocation"});return"denied"===t.state?(console.warn("‚ùå Geolocation access denied."),alert("Location access is blocked. Please enable it in your browser settings."),null):"prompt"!==t.state||e?new Promise((i,e)=>{navigator.geolocation.getCurrentPosition(async e=>{var t=e.coords.latitude,e=e.coords.longitude;console.log("üìç User's Location:",t,e),r();try{var o,a,n=await(async(e,t)=>{try{return(await(async()=>{if(!window.google||!google.maps||!google.maps.Geocoder)return new Promise((e,t)=>{if(window.google&&google.maps&&google.maps.Geocoder)return e();var o=document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-y5SThmDqWvwCQgQ95LF8tsGHV68TJwk&libraries=places",o.async=!0,o.defer=!0,o.onload=()=>{console.log("‚úÖ Google Maps API Loaded"),e()},o.onerror=()=>t(new Error("‚ùå Google Maps API failed to load")),document.head.appendChild(o)})})(),google.maps.Geocoder)?new Promise((o,a)=>{(new google.maps.Geocoder).geocode({location:{lat:e,lng:t}},(e,t)=>{"OK"===t&&0<e.length?(e=e[0].formatted_address,console.log("‚úÖ Address from Coordinates:",e),o(e)):(console.error("‚ùå No address found or geocoding failed:",t),a("Unable to retrieve address."))})}):(console.error("‚ùå Google Maps Geocoder is not available."),null)}catch(e){return console.error("‚ùå Error in getAddressFromCoordinates:",e),null}})(t,e);n?(o=document.getElementById("geo-address"))&&(o.value=n,o.dataset.lat=t,o.dataset.lng=e):l("‚ùå Unable to retrieve address from your location."),window.map&&(console.log("üìå Fitting map to user location"),a=new google.maps.LatLng(t,e),window.map.setCenter(a),window.map.setZoom(10)),window.userLocation={lat:t,lng:e},window.updateMarkersList(),i({lat:t,lng:e})}catch(e){console.error("‚ùå Error fetching address:",e),l("‚ùå Unable to retrieve address from your location."),i(null)}},e=>{console.error("‚ùå Geolocation error:",e),l("‚ùå Unable to get your location. Please enable location services."),i(null)})}):(console.log("‚è≥ Waiting for user to interact before requesting location."),null)}catch(e){return console.error("‚ùå Error checking geolocation permission:",e),null}}function l(e){var t=document.getElementById("address-error");t&&(t.textContent=e,t.style.display="block")}function r(){var e=document.getElementById("address-error");e&&(e.style.display="none",e.textContent="")}function m(e,t,o,a){var n=(o-e)*(Math.PI/180),a=Math.PI/180*(a-t),t=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e*(Math.PI/180))*Math.cos(o*(Math.PI/180))*Math.sin(a/2)*Math.sin(a/2);return(6371*(2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t)))).toFixed(1)}function d(){if(window.map&&window.markers){var e,o=document.getElementById("map_result_count"),d=document.querySelector(".location_hero_list");let t=map.getBounds();t&&(e=markers.filter(e=>t.contains(e.getPosition())),d.innerHTML="",0<e.length?(e.forEach(e=>{var t,o,a,n,i,l,r,s,c;e.extraData?({name:t,link:o,imageUrl:a,distance:n,country:i,state:l,city:r,postcodes:s}=e.extraData,(c=document.createElement("div")).classList.add("location_hero_item"),c.setAttribute("n4-filter-name",t?t.toLowerCase():""),c.setAttribute("n4-filter-city",r?r.toLowerCase():""),c.setAttribute("n4-filter-state",l?l.toLowerCase():""),c.setAttribute("n4-filter-country",i?i.toLowerCase():""),c.setAttribute("n4-filter-postcodes",s?s.toLowerCase():""),c.innerHTML=`
          <div class="location_hero_item_image_wrap">
            <img src="${a}" loading="lazy" alt="${t}" class="location_hero_item_image">
          </div>
          <div class="location_hero_item_content">
            <h4 class="location_hero_item_heading u-text-style-large">${t}</h4>
            ${n?`<p class="u-text-style-small">${n} km away</p>`:""}
            <a href="${o}" class="learnmore_wrap is-underline w-inline-block">
              <div class="learnmore_text u-text-style-main">See location</div>
              <div class="learnmore_underline"></div>
              <div class="learnmore_icon w-embed">
                <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 18 19" fill="none" preserveAspectRatio="xMidYMid meet" aria-hidden="true" role="img">
                  <rect y="0.5" width="18" height="18" rx="9" fill="#EC008C"></rect>
                  <path d="M10.5644 9.11433L8.55285 7.04545L9.08317 6.5L12 9.50002L9.08317 12.5L8.55285 11.9545L10.5644 9.88572H6V9.11433H10.5644Z" fill="white"></path>
                </svg>
              </div>
            </a>
          </div>
        `,d.appendChild(c)):console.warn("‚ùå Missing extraData for marker:",e)}),o.textContent=`Showing ${e.length} Locations`):window.userLocation?(console.warn("‚ùå No visible markers. Displaying the closest 3 locations."),window.markers.forEach(e=>{e.extraData.distance=m(window.userLocation.lat,window.userLocation.lng,e.getPosition().lat(),e.getPosition().lng())}),0<(e=window.markers.filter(e=>null!==e.extraData.distance&&!isNaN(e.extraData.distance)).sort((e,t)=>e.extraData.distance-t.extraData.distance).slice(0,3)).length?(e.forEach((e,t)=>{var{name:e,link:o,imageUrl:a,distance:n}=e.extraData,i=document.createElement("div");i.classList.add("location_hero_item"),i.innerHTML=`
            <div class="location_hero_item_image_wrap">
              <img src="${a}" loading="lazy" alt="${e}" class="location_hero_item_image">
            </div>
            <div class="location_hero_item_content">
              <h4 class="location_hero_item_heading u-text-style-large">${e}</h4>
              <p class="u-text-style-small">${n} km away</p>
              <a href="${o}" class="learnmore_wrap is-underline w-inline-block">
                <div class="learnmore_text u-text-style-main">See location</div>
                <div class="learnmore_underline"></div>
                <div class="learnmore_icon w-embed">
                  <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 18 19" fill="none" preserveAspectRatio="xMidYMid meet" aria-hidden="true" role="img">
                    <rect y="0.5" width="18" height="18" rx="9" fill="#EC008C"></rect>
                    <path d="M10.5644 9.11433L8.55285 7.04545L9.08317 6.5L12 9.50002L9.08317 12.5L8.55285 11.9545L10.5644 9.88572H6V9.11433H10.5644Z" fill="white"></path>
                  </svg>
                </div>
              </a>
            </div>
          `,d.appendChild(i)}),o.textContent="Showing Closest Locations to your current location."):o.textContent="No locations found in this area."):(console.warn("‚ùå No locations available in this area."),o.textContent="No locations found in this area."))}}async function t(e="map_canvas"){var{}=await google.maps.importLibrary("maps"),t=document.getElementById(e);let a=await c(),o={mapTypeId:"roadmap",zoom:12,gestureHandling:window.innerWidth<=425?"greedy":"auto",styles:[{featureType:"administrative",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{saturation:-100},{lightness:"50"},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]},{featureType:"water",elementType:"labels",stylers:[{lightness:-25},{saturation:-100}]}],disableDefaultUI:!0,zoomControl:!0,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0,rotateControl:!1,scaleControl:!1};console.log("Initializing the map:",e);var r=new google.maps.Map(t,o);window.map=r;let n={url:"https://cdn.prod.website-files.com/67ab6f4970b90367b528f15a/67c8f176df8419775322fa3d_NND-marker.svg",scaledSize:new google.maps.Size(50,65),anchor:new google.maps.Point(25,60)},i=[],l=new google.maps.LatLngBounds,s=new google.maps.InfoWindow;locationData.forEach(e=>{let t=null,o=(a&&(t=m(a.lat,a.lng,e.lat,e.lng)),new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:r,icon:n}));o.extraData={name:e.name,link:e.link,imageUrl:e.imageUrl,distance:t,country:e.country,state:e.state,city:e.city,postcodes:e.postcodes||""},o.addListener("click",()=>{s.setContent(`
          <div style="max-width: 250px;">
            <div class="u-vflex-stretch-center u-gap-3">
              <div style="overflow: hidden; border-radius: .75rem;">
                <img style="max-height: 8rem; aspect-ratio: 16 / 9; object-position: 0% 50%;" src="${e.imageUrl}" alt="${e.name}">
              </div>
                <div>
                  <h4 class="location_hero_item_heading u-text-style-large">${e.name}</h4>
                  <p class="u-text-style-tiny">${e.city}, ${e.state}, ${e.country}</p>
                </div>
              ${t?`<p style="margin: 5px 0; font-size: 14px;"><strong>${t} km away</strong></p>`:""}
              <a href="${e.link}" class="learnmore_wrap is-underline w-inline-block">
                <div class="learnmore_text u-text-style-main">See location</div>
                <div class="learnmore_underline"></div>
                <div class="learnmore_icon w-embed">
                  <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 18 19" fill="none" preserveAspectRatio="xMidYMid meet" aria-hidden="true" role="img">
                    <rect y="0.5" width="18" height="18" rx="9" fill="#EC008C"></rect>
                    <path d="M10.5644 9.11433L8.55285 7.04545L9.08317 6.5L12 9.50002L9.08317 12.5L8.55285 11.9545L10.5644 9.88572H6V9.11433H10.5644Z" fill="white"></path>
                  </svg>
                </div>
              </a>
            </div>
          </div>
        `),s.open(r,o)}),i.push(o),l.extend(o.getPosition())}),window.markers=i,console.log("Markers added successfully."),document.querySelectorAll(".n4_loading-skeleton").forEach(e=>{"none"!=e.style.display&&(e.style.display="none")}),document.querySelector(".location_hero_count_wrap").style.display="block",a?(console.log("‚úÖ Centering on user location:",a),r.setCenter(a),r.setZoom(10)):0<i.length&&r.fitBounds(l),r.addListener("bounds_changed",d),setTimeout(d,1e3);new markerClusterer.MarkerClusterer({map:r,markers:i,renderer:{render:function({count:e,position:t}){var o=10*Math.floor(e/10),o=Math.min(40+o,80),a=o/2,n=a,i=a+.1*o,l=Math.floor(o/3),a={url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`
        <svg width="${o}" height="${o}" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${a}" cy="${a}" r="${a}" fill="#EC008C" />
          <text x="${n}" y="${i}" text-anchor="middle" fill="#fff" font-size="${l}" font-family="Arial" font-weight="bold">${e}</text>
        </svg>
        `),scaledSize:new google.maps.Size(o,o)};return new google.maps.Marker({map:r,position:t,icon:a})}},zoomOnClick:!1,onClusterClick:(e,t)=>{r.fitBounds(t.bounds),r.setZoom(10)}});return r}async function o(){var e=new URLSearchParams(window.location.search),t=parseFloat(e.get("lat")),e=parseFloat(e.get("lng"));if(isNaN(t)||isNaN(e)||!window.map){if(window.map&&window.markers){let t=new google.maps.LatLngBounds;window.markers.forEach(e=>t.extend(e.getPosition())),window.map.fitBounds(t)}}else console.log("Centering map from URL parameters:",t,e),window.map.setCenter({lat:t,lng:e}),window.map.setZoom(10)}document.querySelectorAll(".locations_nest").forEach(e=>{e.style.display="none"}),e.forEach(t=>{for(let e=0;e<10;e++){var o=document.createElement("div");o.classList.add("n4-locations_loading-skeleton"),t.appendChild(o)}}),(async()=>{0<window.locationData.length?(console.log("‚úÖ Location data available, initializing map..."),await t(),o()):(console.log("‚è≥ Waiting for location data before initializing map..."),window.addEventListener("locationDataLoaded",async()=>{console.log("üìç locationData is now loaded, initializing map..."),await t(),o()},{once:!0}))})(),document.getElementById("get_location_btn").addEventListener("click",async()=>{r(),await c(!0)}),document.getElementById("geo-address").addEventListener("input",function(){{var s=this.value,e=document.querySelectorAll(".location_hero_item");s=s.trim().toLowerCase();let l=new google.maps.LatLngBounds,r=!1;window.markers.forEach(e=>{var{name:t,city:o,state:a,country:n,postcodes:i}=e.extraData;(t+` ${o} ${a} ${n} `+i).toLowerCase().includes(s)?(e.setMap(window.map),l.extend(e.getPosition()),r=!0):e.setMap(null)}),e.forEach(e=>{var t=e.getAttribute("n4-filter-name")||"",o=e.getAttribute("n4-filter-city")||"",a=e.getAttribute("n4-filter-state")||"",n=e.getAttribute("n4-filter-country")||"",e=e.getAttribute("n4-filter-postcodes")||"";t.includes(s)||o.includes(s)||a.includes(s)||n.includes(s)||e.split(", ").some(e=>e.startsWith(s))}),e=document.querySelectorAll(".location_hero_item:not([style*='display: none'])").length,document.getElementById("map_result_count").textContent=`Showing ${e} Locations`,r&&(window.map.fitBounds(l),1===e)&&window.map.setZoom(14)}r()});let a=document.getElementById("country");e=document.getElementById("area");function n(){document.querySelectorAll(".location_block_item_wrap").forEach(e=>{var t=e.querySelector("[fs-cmsnest-collection='location']");t&&0!==t.children.length?e.style.display="block":e.style.display="none"})}a&&a.addEventListener("change",function(){let o=a.value;document.querySelectorAll(".location_block_item_wrap").forEach(e=>{var t=e.getAttribute("n4-filter-country");e.style.display=""===o||o===t?"block":"none"})}),e&&e.addEventListener("change",function(){setTimeout(n,200)})});