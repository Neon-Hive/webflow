var userLocationAvailable=!1;async function initMap(){var m,e,a,{}=await google.maps.importLibrary("maps"),{}=await google.maps.importLibrary("marker"),u=[],r=[];let t=0;var o,n={mapTypeId:"roadmap",mapId:"f31c4abe96cf22c9",gestureHandling:window.innerWidth<=425?"greedy":"auto"};function s(){for(var e=new google.maps.LatLngBounds,t=0;t<u.length;t++)e.extend(u[t].position);m.fitBounds(e)}function l(t,o){let n=null,a=Number.MAX_VALUE;for(let e=0;e<locations.length;e++){var i=locations[e],r=(r=t,c=o,s=i.latitude,l=i.longitude,void 0,d=void 0,d=p(s-r),l=p(l-c),c=Math.sin(d/2)*Math.sin(d/2)+Math.cos(p(r))*Math.cos(p(s))*Math.sin(l/2)*Math.sin(l/2),6371*(d=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))),s=Math.round(r),l=document.querySelector('div[data-id="'+i.ID+'"]');l.setAttribute("data-distance",r),$(l).find(".studio-distance").text(s+"km away").show(),r<a&&(a=r,n=i)}var r,c,s,l,d;return n}function c(e){var t,o,n,a=e.coords.latitude,e=e.coords.longitude,i=l(a,e);t=document.getElementById("location-list"),(o=Array.from(t.getElementsByClassName("w-dyn-item"))).sort(function(e,t){return parseInt(e.getAttribute("data-distance"))-parseInt(t.getAttribute("data-distance"))}),n=document.createDocumentFragment(),o.forEach(function(e){n.appendChild(e)}),t.innerHTML="",t.appendChild(n),i?(m.setCenter(new google.maps.LatLng(i.latitude,i.longitude)),m.setZoom(14)):(m.setCenter(new google.maps.LatLng(a,e)),m.setZoom(13))}function p(e){return e*(Math.PI/180)}function d(e){switch(e.code){case e.PERMISSION_DENIED:console.log("User denied the request for Geolocation."),s();break;case e.POSITION_UNAVAILABLE:console.log("Location information is unavailable."),s();break;case e.TIMEOUT:console.log("The request to get user location timed out."),s();break;case e.UNKNOWN_ERROR:console.log("An unknown error occurred."),s()}}function g(){var r=document.getElementById("location-search-input-desktop"),s=document.getElementById("location-search-input-mobile"),e=document.getElementById("location-list"),l=Array.from(e.querySelectorAll(".w-dyn-item .studio_nearby-item")),c=document.getElementById("no-results"),d=document.getElementById("results-count");function t(){var e=r.value.toUpperCase(),t=s.value.toUpperCase(),o=e||t,n=!1,a=0,i=new google.maps.LatLngBounds;l.forEach(function(e){e.getAttribute("data-address").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().includes(o)?(e.style.display="",n=!0,a++):e.style.display="none"}),c.style.display=n?"none":"block",d.textContent=`Select from ${a} Resonate studio’s across NZ`,u.forEach(function(e){locations[e._index].address.toUpperCase().includes(o)?(e.map=m,i.extend(e.position)):e.map=null}),document.querySelectorAll(".mapCluster").forEach(e=>{e.style.display=n?"none":""}),0<a&&(m.fitBounds(i),1===a)&&m.setZoom(14)}e=l.length,d.textContent=`Select from ${e} Resonate studio’s across NZ`,r.addEventListener("input",t),s.addEventListener("input",t)}function f(){var e=document.querySelectorAll('#map-radio-filters input[type="radio"]'),t=document.getElementById("location-list");let i=Array.from(t.getElementsByClassName("studio_nearby-item"));console.log(i),e.forEach(function(e){e.addEventListener("change",function(){var o=document.querySelector('#map-radio-filters input[type="radio"]:checked').nextElementSibling.textContent.trim().toLowerCase(),n=new google.maps.LatLngBounds,a=0;u.forEach(function(e){var t=locations[e._index].region.toLowerCase();"select all"===o||t===o?(e.map=m,n.extend(e.position),a++):e.map=null}),i.forEach(function(e){var t=e.getAttribute("data-region").toLowerCase();e.style.display="select all"===o||t===o?"":"none"}),"select all"===o?(m.setCenter(new google.maps.LatLng(-41.2735073,173.2817839)),m.setZoom(6)):(m.fitBounds(n),1===a&&m.setZoom(14),1<a&&m.setZoom(10))})})}$(".studio_nearby-item").click(function(){for(var e=$(this).find("#location-title").text(),o=0;o<u.length;o++)if(u[o].title==e&&(google.maps.event.trigger(u[o],"click"),m.setZoom(15),m.setCenter(u[o].position),window.innerWidth<=425)){let e=u[o].position.lng,t=u[o].position.lat+.004;setTimeout(()=>{m.setCenter(new google.maps.LatLng(t,e))},300),document.getElementById("open-mobile-map").click()}});var h="map_canvas-desktop";if(h){for(geocoder=new google.maps.Geocoder,console.log("Initializing the map: ",h),e=document.getElementById(h),m=new google.maps.Map(e,n),i=0;i<locations.length;i++){var v=locations[i],C=locations[i].latitude,y=locations[i].longitude,w=(C=C,y=y,o=i,w=void 0,w=(w=new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="50" height="66" viewBox="0 0 50 66" fill="none"><g filter="url(#filter0_i_324_412)"><path d="M24.75 0C18.1882 0.00769411 11.8972 2.70538 7.25733 7.50123C2.61742 12.2971 0.00744394 18.7994 0 25.5818C0 47.4716 22.5 64.0039 23.4591 64.6957C23.8374 64.9697 24.2881 65.1166 24.75 65.1166C25.2119 65.1166 25.6626 64.9697 26.0409 64.6957C27 64.0039 49.5 47.4716 49.5 25.5818C49.4926 18.7994 46.8826 12.2971 42.2427 7.50123C37.6028 2.70538 31.3118 0.00769411 24.75 0Z" fill="#FF714D"/></g><path d="M17.75 34.6259V18.2519H20.4748V21.4284C20.7705 20.4242 21.3408 19.6164 22.1856 19.0051C23.0516 18.3938 23.9599 18.0881 24.9104 18.0881C25.3751 18.0881 25.787 18.1318 26.146 18.2191V21.1337C25.7658 20.959 25.2695 20.8717 24.6569 20.8717C23.5586 20.8717 22.587 21.3629 21.7421 22.3454C20.8972 23.3278 20.4748 24.7141 20.4748 26.5044V34.6259H17.75Z" fill="white"/><path d="M30.2664 34.0774C29.9291 34.4427 29.5114 34.6253 29.0135 34.6253C28.5155 34.6253 28.0899 34.4427 27.7365 34.0774C27.3991 33.7121 27.2305 33.2722 27.2305 32.7575C27.2305 32.2594 27.4072 31.8277 27.7605 31.4624C28.1139 31.0806 28.5316 30.8896 29.0135 30.8896C29.4954 30.8896 29.913 31.0806 30.2664 31.4624C30.6198 31.8277 30.7965 32.2594 30.7965 32.7575C30.7965 33.2722 30.6198 33.7121 30.2664 34.0774Z" fill="white"/><defs><filter id="filter0_i_324_412" x="0" y="0" width="49.5" height="65.6167" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="0.5"/><feGaussianBlur stdDeviation="1.5"/><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="shape" result="effect1_innerShadow_324_412"/></filter></defs></svg>',"image/svg+xml").documentElement,(C=new google.maps.marker.AdvancedMarkerElement({map:m,content:w,position:new google.maps.LatLng(C,y),title:locations[o].name}))._index=o,u.push(C),t++,google.maps.event.addListener(C,"click",((o,n)=>function(){a&&a.close(),m.setCenter(o.position);let e=m.getZoom(),t=setInterval(()=>{16<=e?clearInterval(t):(e+=.5,m.setZoom(e))},100);(a=r[n]).open(m,o)})(C,o)),t==locations.length&&(navigator.geolocation?navigator.geolocation.getCurrentPosition(c,d):(console.log("This browser does not support geolocation"),s())),new google.maps.InfoWindow);w.setContent('<div class="map-wrap"><div class="map-header-wrapper"><div class="map-title-inner"><div class="map-title">'+v.name+'</div><div class="text-color-orange">Resonate Studio</div></div>'+(v.image?'<img class="studio_nearby-image" src="'+v.image+'" alt="'+v.name+'">':"")+'</div><div class="map-address"><a href="'+v.directions+'" tabindex="0" target="_blank"><i class="fa-solid fa-location-dot"></i>'+v.address+'</a></div><div class="map-button-wrapper"><a href="'+v.url+'" class="button-map-details">View studio details</a><a href="'+v.directions+'" class="button-map-directions" target="_blank">Get Directions<i class="fa-solid fa-arrow-right"></i></a></div></div>'),r.push(w)}new markerClusterer.MarkerClusterer({map:m,markers:u,renderer:{render:function({count:e,position:t}){var o=document.createElement("div");return o.className="mapCluster",o.textContent=e,new google.maps.marker.AdvancedMarkerElement({map:m,position:t,content:o})}},zoomOnClick:!1,onClusterClick:(e,t,o)=>{o.fitBounds(t.bounds),o.setZoom(10)}});navigator.geolocation.getCurrentPosition(function(e){userLocationAvailable=!0,c(e),g(),f()},function(e){var t,o;m.setCenter(new google.maps.LatLng(-41.2735073,173.2817839)),m.setZoom(6),console.log(e),e=document.getElementById("location-list"),(t=Array.from(e.getElementsByClassName("w-dyn-item"))).sort(function(e,t){e=e.querySelector("#location-title").textContent.toUpperCase(),t=t.querySelector("#location-title").textContent.toUpperCase();return e.localeCompare(t)}),o=document.createDocumentFragment(),t.forEach(function(e){o.appendChild(e)}),e.innerHTML="",e.appendChild(o),g(),f()}),console.log("Initializing map: ",h," finished")}}document.addEventListener("DOMContentLoaded",function(){initMap(),document.querySelector("#map-form form").addEventListener("submit",function(e){e.preventDefault()});let o=document.querySelector(".finder_main-filter-toggle"),n=document.querySelector(".finder_main-filter-list");var e=document.querySelectorAll(".main_filter-list-content input[type='radio']");e.forEach(e=>{e.addEventListener("change",e=>{var t,e=e.target.nextElementSibling.textContent;e=e,(t=o.querySelector("div"))&&(t.textContent=e),n.classList.contains("w--open")&&o.classList.contains("w--open")&&(t=new Event("w-close",{bubbles:!0,cancelable:!0}),o.dispatchEvent(t),n.classList.remove("w--open"),o.classList.remove("w--open"),o.setAttribute("aria-expanded","false"))})})});